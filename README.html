<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<h1 id="readme">Readme</h1>
<h2 id="what-is-this-plugin">What is this plugin ?</h2>
<p>This plugin is a flexible helper for compiling directly from vim. Compilation and execution command are run using the first avalaible of the following options:</p>
<ol style="list-style-type: decimal">
<li>Custom function (see <a href="#configuration">configuration</a> )</li>
<li><a href="https://github.com/tpope/vim-dispatch">Dispatch</a></li>
<li>Vim shell escape (<code>:make</code> and <code>:!</code>)</li>
</ol>
<p>It also provides an easy and unified way to set and use compilers, and natively integrate with <a href="http://vim-latex.sourceforge.net/">vim-latex-suite</a> compilation settings.</p>
<h2 id="what-is-new">What is new ?</h2>
<ul>
<li><p>Since v0.2.3, vim-compile will try to retrieve the latex main file for compilation and execution.</p>
<p>If latex-suite is activated, it search for a <code>*.latexmain</code> file, else it looks for a root file line, similar to the following:</p>
<pre><code>%!TEX root=my_main_file.tex</code></pre></li>
<li><em>Note</em> Since v0.2.2, you need to use <code>function()</code> to set a custom starter function.</li>
<li><p>Since v0.2 you can define a custom function to launch commands (compilation and exectuion), see <a href="#configuration">configuration</a>.</p></li>
</ul>
<h2 id="install">Install</h2>
<h3 id="quick-install">Quick install</h3>
<pre><code>git clone https://github.com/dbeniamine/vim-compile.git
cd vim-compile/
cp -r ./* ~/.vim</code></pre>
<h3 id="pathogen-install">Pathogen install</h3>
<pre><code>git clone https://github.com/dbeniamine/vim-compile.git ~/.vim/bundle/vim-compile</code></pre>
<h2 id="features">Features</h2>
<p>This plugin provides an easy way to compile and execute any file.</p>
<p>Some compilation and executions rules are predefined for a few filetypes, but the user can redefine them, see <a href="#configuration">configuration</a> for how.</p>
<p>If a <code>Makefile</code> exists in the working directory, <code>make</code> will be prefered over the predefined rule. The same way, if a <code>build.xml</code> file exists, <code>ant</code> will be prefered.</p>
<p>For latex files, if <a href="http://vim-latex.sourceforge.net/">vim-latex-suite</a> is present, the predefined rules will be overwritten vy vim-late-suite settings. Vim-compile will always try to guess if the current file is part of a bigger latex project either using <code>*.latexmain</code> file (see help latex-master-file) or by searching for a line Ì€like <code>%!TEX root=my_main_file.tex</code> in the current file. For these kind of project, vim should be open from the directory containing the main file.</p>
<p>The compilation/execution function is visible to the user, and can be easily called. Still some usefull compilation mappings are defined:</p>
<pre><code>&quot; make only
noremap &lt;leader&gt;m :call VimCompileCompile(1,0,0,0,0,0)&lt;CR&gt;

&quot; make and execute
noremap &lt;leader&gt;me :call VimCompileCompile(1,0,0,0,1,0)&lt;CR&gt;

&quot; make and make install
noremap &lt;leader&gt;mi :call VimCompileCompile(1,1,0,1,0,0)&lt;CR&gt;

&quot; make parallel
noremap &lt;leader&gt;mj :call VimCompileCompile(1,1,1,0,0,0)&lt;CR&gt;

&quot; make install parallel
noremap &lt;leader&gt;mij :call VimCompileCompile(1,1,1,1,0,0)&lt;CR&gt;

&quot; make parallel and execute
noremap &lt;leader&gt;mje :call VimCompileCompile(1,1,1,0,1,0)&lt;CR&gt;

&quot; make clean
noremap &lt;leader&gt;mc :call VimCompileCompile(1,0,0,0,0,1)&lt;CR&gt;

&quot; make clean and make
noremap &lt;leader&gt;mc :call VimCompileCompile(1,0,0,0,0,1)&lt;CR&gt;

&quot; execute
noremap &lt;leader&gt;e :call VimCompileCompile(0,0,0,0,1,0)&lt;CR&gt;&lt;CR&gt;</code></pre>
<p>It is possible to add other mappings, there is the specification of the compile function:</p>
<pre><code>&quot; Launch a compilation
&quot; All arguments are booleans
&quot; args:
&quot;   compi:      Do compile (or clean)
&quot;   forcemake:  Use make whatever (for make install / make clean rules)
&quot;   parallel:   Pass -j option to Makefile, require forcemake
&quot;   install:    Do installation, require forcemake
&quot;   exec:       Start an execution
&quot;   clean:      Make clean, require forcemake
function! VimCompileCompile(compi, forcemake, parallel, install, exec,clean)</code></pre>
<h2 id="configuration"><a name=configuration>Configuration</a></h2>
<p>Two dictionaries (see :help Dictionary) can be used to modify or add compilation and execution rules. For instances adding the following to your vimrc will change the compilation and execution rules for pandoc files</p>
<pre><code>let g:VimCompileExecutors={&#39;pandoc&#39; : &quot;firefox %:t:r.html &gt; /dev/null 2&gt;&amp;1&quot;,}
let g:VimCompileCompiler={&#39;pandoc&#39; : &quot;pandoc --smart --standalone --mathml --listings % &gt; %:t:r.html&quot;,}</code></pre>
<p>The following variable gives the default execution rule if none are defined for the filetype:</p>
<pre><code>let g:VimCompileDefaultExecutor=&quot;./%&quot;</code></pre>
<p>A custom starter function (responsible for starting compilation and execution) can be provided by setting the following variable:</p>
<pre><code> let g:VimCompileCustomStarter=function(&quot;MyStarterFunction&quot;)</code></pre>
<p>A starter functions takes two arguments:</p>
<ul>
<li>the first is the command to execute</li>
<li>the second is a character:
<ul>
<li><code>'m'</code> indicate that we are doing an actual compilation</li>
<li><code>'e'</code> means that we run a custom command.</li>
</ul></li>
</ul>
<p>For a better understanding of starter functions, there is the default one:</p>
<pre><code>&quot; Default command starter {{{2
&quot; Start a command using Dispatch if available or the shell escape
&quot; Arguments: cmd: the command to execute
&quot;            type: &#39;m&#39; if we are doing a compilation, &#39;e&#39; otherwise
function! VimCompileDefaultStartCmd(cmd,type)
    if (a:type==&#39;m&#39;) &quot; Compilation: use makeprg and :Dispatch or :make
        let &amp;makeprg=a:cmd
        if exists(&quot;g:loaded_dispatch&quot;)
            let l:launcher=&quot;:Dispatch&quot;
        else
            let l:launcher=&quot;:make&quot;
        endif
    else &quot; Normal command
        let l:cmd=a:cmd
        if exists(&quot;g:loaded_dispatch&quot;)
            let l:launcher=&quot;:Start&quot;
            if (a:cmd=~&#39;^.*&amp;\s*$&#39;) &quot; Let Dispatch handle background commands
                let l:cmd=substitute(a:cmd,&#39;&amp;\s*$&#39;,&#39;&#39;,&#39;&#39;)
                let l:launcher.=&quot;!&quot;
            endif
        else &quot; Simple shell escape
            let l:launcher=&quot;:!&quot;
        endif
        let l:launcher.=&quot; &quot;.l:cmd
    endif
    execute l:launcher
endfunction</code></pre>
</body>
</html>
